---
layout: post
title: "WPF DataBinding and Application Settings"
date: 2007-02-15 21:47:00 -0500
comments: true
category: Archive
tags: [".NET"]
redirect_from: ["/post/2007/02/15/WPF-DataBinding-and-Application-Settings", "/post/2007/02/15/wpf-databinding-and-application-settings"]
author: jerome
---
<!-- more -->
<p align="justify">
<font face="trebuchet ms,geneva" size="2">Well, yet an other post on WPF and some DataBinding. But this time, this is about DataBinding to application settings that are automatically generated by visual studio. These settings come in handy when you want to save your application settings per user, or have some application wide settings. In my case, I wanted to have my application to remember its size and position, as well as the window state. </font>
</p>
<p align="justify">
<font face="trebuchet ms,geneva" size="2">WinForms were providing an UI to do this, and I wanted to have all that functionality back. It is not all that &quot;visual&quot; as WinForms can do it, but it works rather well. I guess that Orcas will provide a way to do this visually. </font>
</p>
<p align="justify">
<font face="trebuchet ms,geneva" size="2">All I had to do to use these settings from XAML was&nbsp;to create a resource to be usable for DataBinding, from a separate file :</font> 
</p>
<font face="courier new,courier">[code:xml]<br />
File: SettingsRes.xaml<br />
<br />
&lt;ResourceDictionary xmlns=<a href="http://schemas.microsoft.com/winfx/2006/xaml/presentation">http://schemas.microsoft.com/winfx/2006/xaml/presentation</a> <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xmlns:x=<a href="http://schemas.microsoft.com/winfx/2006/xaml">http://schemas.microsoft.com/winfx/2006/xaml</a>&nbsp;<br />
<span style="color: #ff0000"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<em>xmlns:settings = &quot;clr-namespace:WindowsApplication2.Properties&quot;</em></strong></span>&gt;<br />
&nbsp; &lt;ResourceDictionary.MergedDictionaries&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;ResourceDictionary&gt;<br />
</font><font face="courier new,courier"><span style="color: #ff0000"><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <em>&lt;settings:Settings x:Key=&quot;settings&quot; /&gt;</em><br />
</strong></span>&nbsp;&nbsp;&nbsp; &lt;/ResourceDictionary&gt;<br />
&nbsp; &lt;/ResourceDictionary.MergedDictionaries&gt;<br />
&lt;/ResourceDictionary&gt;<br />
[/code]</font><br />
<p align="justify">
<font face="trebuchet ms,geneva"><font size="2">WindowsApplication2 is the default namespace for the application, and since the Settings class is automatically generated, the default namespace is used. This resource will be used application wide and is referenced like this :</font> </font>
</p>
<p>
<font face="courier new,courier">[code:xml]<br />
&lt;Application.Resources&gt;<br />
&nbsp; &lt;ResourceDictionary&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;ResourceDictionary.MergedDictionaries&gt;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #ff0000"><strong><em>&lt;ResourceDictionary Source = &quot;SettingsRes.xaml&quot;/&gt;</em></strong><br />
&nbsp;&nbsp;&nbsp; </span>&lt;/ResourceDictionary.MergedDictionaries&gt;<br />
&nbsp; &lt;/ResourceDictionary&gt;<br />
&lt;/Application.Resources&gt; <br />
[/code]</font> 
</p>
<p align="justify">
<font face="trebuchet ms,geneva" size="2">This is handy because resources are separated in multiple files. I also add here references to value converters, when I have to use them everywhere in the application. Value converters, yet an other interesting subject. Maybe in an other post :) </font>
</p>
<p align="justify">
<font face="trebuchet ms,geneva" size="2">Now, about binding the data. We want to bind the Width, Height and WindowState of the default Window to some settings in the ApplicationSettings. </font>
</p>
<p align="justify">
<font face="trebuchet ms,geneva" size="2">Here&#39;s what to do : </font>
</p>
<p>
<font face="courier new,courier">[code:xml]<br />
&lt;Window x:Class=&quot;WindowsApplication2.Window1&quot; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xmlns = <a href="http://schemas.microsoft.com/winfx/2006/xaml/presentation">http://schemas.microsoft.com/winfx/2006/xaml/presentation</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xmlns:x = <a href="http://schemas.microsoft.com/winfx/2006/xaml">http://schemas.microsoft.com/winfx/2006/xaml</a> <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Height = <span style="color: #ff0000"><strong><em>&quot;{Binding Source={StaticResource settings}, Path=Default.MainWidth, Mode=TwoWay}&quot;<br />
</em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </strong></span>Width = <span style="color: #ff0000"><strong><em>&quot;{Binding Source={StaticResource settings}, Path=Default.MainHeight, Mode=TwoWay}&quot;</em></strong></span> <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WindowState = <span style="color: #ff0000"><strong><em>&quot;{Binding Source={StaticResource settings}, Path=Default.MainState, Mode=TwoWay}&quot;</em></strong></span>&gt; <br />
[/code]</font> 
</p>
<p align="justify">
<font face="trebuchet ms,geneva" size="2">We create three bindings, each for an attribute, and set the source to the &quot;settings&quot; resource. The interesting part here is that the even thought the property we use is static, Settings.Default here, the Binding engine does seem to support it. </font>
</p>
<p align="justify">
<font face="trebuchet ms,geneva" size="2">Setting the binding path to Default.MainWidth binds to the appropriate property. The last parameter instructs the binding to set the value of the property when the binding destination value&nbsp;changes, which can be the actual window height, for instance. The type of the property does not need to match the destination exact type, and since the type of the WindowState property is not known by VS2005 settings designer by default, setting the type to string seems to be enough. </font>
</p>
<p align="justify">
<font face="trebuchet ms,geneva" size="2">Simple and easy. Now my application remembers where it was ! </font>
</p>
<p align="justify">
<a href="/files/wpf-appsettings-databinding.zip"><font face="trebuchet ms,geneva" size="2">The sample here</font></a><font size="2"><font face="trebuchet ms,geneva"> is a bit more complex, since it includes code to actually save the settings. But this is nothing really complex.</font><font face="trebuchet ms,geneva"> </font></font>
</p>
<p align="justify">
<font face="trebuchet ms,geneva" size="2">Man ! I like WPF... ! </font>
</p>

{% include imported_disclaimer.html %}
